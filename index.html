<!DOCTYPE html>
<html>
    <head>
        <!-- Required meta tags -->
       <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <title>Know Thyself</title>
	<meta name="title" content="Job Face Analyzer">
	<meta name="subject" content="AI anlyzes your job face">
	<meta name="keywords" content="AI, job face">
	<meta name="author" content="Beth Kim Corporation">
    <link rel="stylesheet" href="style.css">
		<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-634eb52ccb20129c"></script>

    </head>
    <body>
           <nav class="navbar navbar-expand-lg navbar-light nav-distance">
        <a class="navbar-brand" href="#">직업 테스트</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item active">
                    <a class="nav-link" href="#">Home
                        <span class="sr-only">(current)</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Features</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Pricing</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
                </li>
            </ul>
        </div>
    </nav>
<section class="section">
	
        <h1 class="title">인공지능 직업 테스트 </h1>
        <h2 class="subtitle">나는 어떤 직업 얼굴일까?</h2>
    </section>


        <section>
            <div class="preview"></div>
			<p class="result-messege">
				
			</p>
            <button id="triggerUpload" class="btn">Upload Image</button>
            <input type="file" id="filePicker" />
            <div class="fileName"></div>
        </section>
		        <div id="label-container"></div>
		<div id="disqus_thread"></div>
		
		
                <!-- Go to www.addthis.com/dashboard to customize your tools -->
                <div class="addthis_inline_share_toolbox"></div>
            
		
		<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>

<script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://knowthyself-1.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <!-- Optional JavaScript; choose one of the two! -->

        <!-- Option 1: Bootstrap Bundle with Popper -->
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
            crossorigin="anonymous"
        ></script>

        <!-- Option 2: Separate Popper and Bootstrap JS -->
        <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.min.js" integrity="sha384-IDwe1+LCz02ROU9k972gdyvl+AESN10+x7tBKgc9I5HFtuNz0wWnPclzo6p9vxnk" crossorigin="anonymous"></script>
    -->
        <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>
		<script src="http://code.jquery.com/jquery-latest.js"></script> 
        <script type="text/javascript">
            // More API functions here:
            // https://github.com/googlecreativelab/teachablemachine-community/tree/master/libraries/image

            // the link to your model provided by Teachable Machine export panel
            const URL = 'https://teachablemachine.withgoogle.com/models/gjfU9uMLO/';
            let model, webcam, labelContainer, maxPredictions;

            // Load the image model and setup the webcam
            async function init() {
                const modelURL = URL + 'model.json';
                const metadataURL = URL + 'metadata.json';

                // load the model and metadata
                // Refer to tmImage.loadFromFiles() in the API to support files from a file picker
                // or files from your local hard drive
                // Note: the pose library adds "tmImage" object to your window (window.tmImage)
                model = await tmImage.load(modelURL, metadataURL);
                maxPredictions = model.getTotalClasses();
                labelContainer = document.getElementById('label-container');
                for (let i = 0; i < maxPredictions; i++) {
                    // and class labels
                    labelContainer.appendChild(document.createElement('div'));
                }
            }

            // run the webcam image through the image model
            async function predict() {
                var image = document.getElementById('img-preview');
                // predict can take in an image, video or canvas html element
                const prediction = await model.predict(image, false);
				prediction.sort((a,b) => parseFloat(b.probability) - parseFloat(a.probability));
				var resultTitle;
				console.log(prediction[0].className);
				switch (prediction[0].className){
					case "0. Accountant":
						resultTitle = "0. Accountant"
					break;
					case "1. Actor*":
						resultTitle = "1. Actor"
					break;
						case "2. Architect*":
						resultTitle = "2. Architect"
					break;
						case "3. Artist":
						resultTitle = "3. Artist"
					break;
						case "4. Athlete":
						resultTitle = "4. Athlete"
					break;
						case "5. Chef":
						resultTitle = "5. Chef"
					break;
						case "6. Programmer*":
						resultTitle = "6. Programmer"
					break;
						case "7. Designer":
						resultTitle = "7. Designer"
					break;
						case "8. Doctor*":
						resultTitle = "8. Doctor*"
					break;
						case "9. Engineer":
						resultTitle = "9. Engineer"
					break;
						case "10. Entrepreneur*":
						resultTitle = "10. Entrepreneur"
					break;
						case "11. Firefighter":
						resultTitle = "11. Firefighter"
					break;
						case "12. Lawyer":
						resultTitle = "12. Lawyer"
					break;
						case "13. Musician":
						resultTitle = "13. Musician"
					break;
						case "14. Pilot":
						resultTitle = "14. Pilot"
					break;
						case "15. Police Officer*":
						resultTitle = "15. Police Officer"
					break;
						case "16. Politician*":
						resultTitle = "16. Politician"
					break;
						case "17. Scientist":
						resultTitle = "17. Scientist"
					break;
						case "18. Teacher":
						resultTitle = "18. Teacher"
					break;
						case "19. Writer":
						resultTitle = "19. Writer"
					break;
					default: resultTitle = "unknown"
										
								}
				$('.result-message').html(resultTitle);
                for (let i = 0; i < maxPredictions; i++) {
                    const classPrediction =
                        prediction[i].className + ': ' + prediction[i].probability.toFixed(2);
                    labelContainer.childNodes[i].innerHTML = classPrediction;
                }
            }
        </script>
        <script>
            var triggerUpload = document.getElementById('triggerUpload'),
                upInput = document.getElementById('filePicker'),
                preview = document.querySelector('.preview');

            //force triggering the file upload here...
            triggerUpload.onclick = function () {
                upInput.click();
            };

            upInput.onchange = function (e) {
                var uploaded = this.value,
                    ext = uploaded.substring(uploaded.lastIndexOf('.') + 1),
                    ext = ext.toLowerCase(),
                    fileName = uploaded.substring(uploaded.lastIndexOf('\\') + 1),
                    accepted = ['jpg', 'png', 'gif', 'jpeg'];

                /*
    ::Add in blank img tag and spinner
    ::Use FileReader to read the img data
    ::Set the image source to the FileReader data
  */
                function showPreview() {
                    preview.innerHTML = "<div class='loadingLogo'></div>";
                    preview.innerHTML += '<img id="img-preview" />';
                    var reader = new FileReader();
                    reader.onload = function () {
                        var img = document.getElementById('img-preview');
                        img.src = reader.result;
                    };
                    reader.readAsDataURL(e.target.files[0]);
                    preview.removeChild(document.querySelector('.loadingLogo'));
                    document.querySelector('.fileName').innerHTML = fileName + '<b> Uploaded!</b>';
					init().then(function(){
						predict();
					});
					
                }

                //only do if supported image file
                if (new RegExp(accepted.join('|')).test(ext)) {
                    showPreview();
                } else {
                    preview.innerHTML = '';
                    document.querySelector('.fileName').innerHTML =
                        'Upload an image file, not a <b>.' + ext + '</b> file!';
                }
            };
        </script>
    </body>
</html>